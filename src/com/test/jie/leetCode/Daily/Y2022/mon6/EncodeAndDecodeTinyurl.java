package com.test.jie.leetCode.Daily.Y2022.mon6;

import java.util.HashMap;
import java.util.Map;
import java.util.Random;

/**
 * 535. TinyURL çš„åŠ å¯†ä¸è§£å¯†
 * TinyURL æ˜¯ä¸€ç§ URL ç®€åŒ–æœåŠ¡ï¼Œ æ¯”å¦‚ï¼šå½“ä½ è¾“å…¥ä¸€ä¸ª URL https://leetcode.com/problems/design-tinyurl æ—¶ï¼Œ
 * å®ƒå°†è¿”å›ä¸€ä¸ªç®€åŒ–çš„URL http://tinyurl.com/4e9iAk ã€‚è¯·ä½ è®¾è®¡ä¸€ä¸ªç±»æ¥åŠ å¯†ä¸è§£å¯† TinyURL ã€‚
 * <p>
 * åŠ å¯†å’Œè§£å¯†ç®—æ³•å¦‚ä½•è®¾è®¡å’Œè¿ä½œæ˜¯æ²¡æœ‰é™åˆ¶çš„ï¼Œä½ åªéœ€è¦ä¿è¯ä¸€ä¸ª URL å¯ä»¥è¢«åŠ å¯†æˆä¸€ä¸ª TinyURL ï¼Œå¹¶ä¸”è¿™ä¸ª TinyURL å¯ä»¥ç”¨è§£å¯†æ–¹æ³•æ¢å¤æˆåŸæœ¬çš„ URL ã€‚
 * <p>
 * å®ç° Solution ç±»ï¼š
 * <p>
 * Solution() åˆå§‹åŒ– TinyURL ç³»ç»Ÿå¯¹è±¡ã€‚
 * String encode(String longUrl) è¿”å› longUrl å¯¹åº”çš„ TinyURL ã€‚
 * String decode(String shortUrl) è¿”å› shortUrl åŸæœ¬çš„ URL ã€‚é¢˜ç›®æ•°æ®ä¿è¯ç»™å®šçš„ shortUrl æ˜¯ç”±åŒä¸€ä¸ªç³»ç»Ÿå¯¹è±¡åŠ å¯†çš„ã€‚
 * <p>
 * <p>
 * ç¤ºä¾‹ï¼š
 * è¾“å…¥ï¼šurl = "https://leetcode.com/problems/design-tinyurl"
 * è¾“å‡ºï¼š"https://leetcode.com/problems/design-tinyurl"
 * <p>
 * è§£é‡Šï¼š
 * Solution obj = new Solution();
 * string tiny = obj.encode(url); // è¿”å›åŠ å¯†åå¾—åˆ°çš„ TinyURL ã€‚
 * string ans = obj.decode(tiny); // è¿”å›è§£å¯†åå¾—åˆ°çš„åŸæœ¬çš„ URL ã€‚
 * <p>
 * æç¤ºï¼š
 * 1 <= url.length <= 104
 * é¢˜ç›®æ•°æ®ä¿è¯ url æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ URL
 */
public class EncodeAndDecodeTinyurl {

    /**
     * å…³äºä½¿ç”¨ã€Œè‡ªå¢ idã€çš„ç­”ç–‘
     * ä¸ºå•¥è¦ä½¿ç”¨ã€Œå“ˆå¸Œå­˜å‚¨æ˜ å°„å…³ç³»ã€çš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ç”¨ã€Œè‡ªå¢ idã€çš„æ–¹å¼ï¼Œæ„Ÿè§‰å¯èƒ½æ˜¯ä¸€éƒ¨åˆ†åŒå­¦çš„å…±åŒç–‘æƒ‘ï¼Œè¿™é‡Œç»Ÿä¸€å›ç­”ä¸€ä¸‹ã€‚
     *
     * å…¶ä¸­ä¸¤ç‚¹è¾ƒä¸ºè‡´å‘½çš„å¼Šç«¯æ˜¯ï¼š
     *
     * ä½¿ç”¨ã€Œè‡ªå¢ idã€æ›´å®¹æ˜“è¢«æšä¸¾ï¼›
     * ï¼ˆå†è¡¥å……ï¼Œæå‡ºåŸé—®é¢˜çš„å¥½å¥‡å®å®åˆé—®äº†å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼‰å…³äºè¢«æšä¸¾çš„åå¤„ï¼šç²—ç•¥æ¥è¯´ä¼šå¯¼è‡´å®‰å…¨æ€§ä¸‹é™ï¼Œè¢«æ”»å‡»çš„å¯èƒ½æ€§å¤§å¤§å¢å¼ºã€‚
     * å› ä¸ºå¯æšä¸¾æ„å‘³ç€ï¼Œä¸èƒ½å…‰é  URL ç‰¹å®šå‘æ”¾æ¥ç¡®ä¿å®‰å…¨ã€‚
     *
     * ç»“åˆå…·ä½“åœºæ™¯æ¥è¯´ï¼Œå‡è®¾æŸä¸ªæ´»åŠ¨æ—¥æœŸç”Ÿæˆäº†çŸ­ URL çš„æ´»åŠ¨é“¾æ¥ï¼Œåªæœ‰ç‰¹å®šç”¨æˆ·å¯ä»¥è®¿é—®ï¼Œ
     * å¯æšä¸¾æ„å‘³ç€ç«å“åªéœ€è¦å¤§æ¦‚çŸ¥é“ä½ è‡ªå¢ id å½“å‰åœ¨ä»€ä¹ˆèŒƒå›´å³å¯æ‹¿åˆ°æ´»åŠ¨é“¾æ¥ï¼Œå³ä½¿æ´»åŠ¨é“¾æ¥åšäº†é‰´æƒï¼Œ
     * ä¹Ÿèƒ½é€šè¿‡æ”»å‡»æ‰‹æ®µå¯¼è‡´æœåŠ¡è¯·æ±‚æ•°é‡çªå¢ï¼Œå½±å“çœŸå®çš„æ´»åŠ¨ç”¨æˆ·ä½¿ç”¨ã€‚
     *
     * æˆ–è®¸è¿™ä¸ªåœºæ™¯å¹¶ä¸è‡´å‘½ï¼Œç«å“è¦æ‹¿åˆ°æ´»åŠ¨é“¾æ¥æœ‰å¾ˆå¤šæ–¹å¼ï¼Œæœªå¿…æ˜¯é€šè¿‡æšä¸¾çŸ­ URL æ¥åšåˆ°ã€‚
     * ä½†å¦å¤–ä¸€ä¸ªåœºæ™¯åˆ™æ˜¯è‡´å‘½çš„ï¼Œå°±æ˜¯å¯æšä¸¾ä¼šå¯¼è‡´ä½¿ç”¨çŸ­ URL æœåŠ¡çš„ã€ŒéªŒè¯æœåŠ¡ã€å¤±æ•ˆã€‚
     *
     * ä¾‹å¦‚æŸä¸ªæœåŠ¡ä¼šé€šè¿‡ã€Œé‚®ä»¶/çŸ­ä¿¡ã€å‘é€çŸ­ URL é“¾æ¥ï¼Œè®©ç”¨æˆ·é€šè¿‡ç‚¹å‡»çŸ­ URL æ¥éªŒè¯æ˜¯å¦ä¸ºæŸä¸ªã€Œé‚®ç®±/æ‰‹æœºå·ã€çš„æ‹¥æœ‰è€…ï¼Œ
     * çŸ­ URL å¯æšä¸¾ï¼Œæ„å‘³ç€åªéœ€è¦çŸ¥é“å½“å‰è‡ªå¢ id å¤§æ¦‚èŒƒå›´ï¼Œå°±å¯é€šè¿‡æšä¸¾çš„æ–¹å¼è®¿é—®åˆ°çœŸå®çš„éªŒè¯åœ°å€ï¼Œä»è€Œå®ç°ã€Œä¸æ”¶åˆ°æŸä¸ªé‚®ä»¶/çŸ­ä¿¡ã€ä¹Ÿå¯ä»¥é€šè¿‡éªŒè¯çš„ç›®çš„ã€‚
     *
     * ç›¸æ¯”äºä½¿ç”¨ã€Œå“ˆå¸Œå­˜å‚¨æ˜ å°„å…³ç³»ã€çš„æ–¹å¼ï¼Œä¸å¥½é‡ç”¨ï¼š
     *
     * ä¸¾ä¸ªğŸŒ°ï¼Œä¾‹å¦‚æ˜ å°„å…³ç³»éƒ½æ˜¯ 77 å¤©è¿‡æœŸï¼Œæ¯å¤©ä¼šäº§ç”Ÿäº† 1010 ä¸ªçŸ­ URLï¼Œå½“è¿›è¡Œåˆ°ç¬¬ 88 å¤©ï¼Œæ­¤æ—¶ id å·²ç»è‡ªå¢åˆ° 7171ï¼Œ
     * åŒæ—¶ç¬¬ä¸€å¤©äº§ç”Ÿçš„çŸ­ URL å·²è¿‡æœŸï¼Œä½†æ˜¯å®ç°ä¸Šï¼Œæˆ‘ä»¬ä¸å¥½å°† id è¿›è¡Œå›æ‹¨ï¼ˆéœ€è¦è€ƒè™‘å½“é‡ç”¨æ•°å­—ç”¨å®Œåè¦å›åˆ° 7171 çš„ä½ç½®ï¼‰ã€‚
     * ä¹Ÿå°±æ˜¯è¯´ï¼Œå‘ç°è€Œä¸”é‡ç”¨æŸäº›æ•°å­—æ®µï¼ˆè¿‡æœŸçš„ idï¼‰ä¼šä¸ºâ€œè‡ªå¢â€å¸¦æ¥å›°æ‰°ï¼Œè€Œå¼•å…¥ã€Œé‡ç”¨æ± ã€åˆ™è¿èƒŒäº†é€‰æ‹©è‡ªå¢æ–¹æ¡ˆçš„åˆè¡·ã€‚
     *
     * ä½†ã€Œå“ˆå¸Œå­˜å‚¨æ˜ å°„å…³ç³»ã€è¦å®ç°é‡ç”¨åˆ™æ˜¯ç®€å•çš„ï¼Œå¦‚æœéšæœºäº§ç”Ÿçš„çŸ­ URL å‘ç”Ÿå†²çªï¼Œåªéœ€è¦ç›´æ¥æ‹’ç»è¿›è¡Œé‡è¯•å³å¯ï¼Œ
     * ä¸€æ—¦äº§ç”ŸçŸ­ URL æ— å†²çªï¼Œåˆ™å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚åŒæ—¶ç”±äºéšæœºé€šå¸¸æœä»æŸç§åˆ†å¸ƒï¼Œæˆ‘ä»¬æ— é¡»å¼•å…¥ã€Œè¿‡æœŸæ—¶é—´æˆ³ã€ç­‰ä¿¡æ¯ï¼Œ
     * å³å¯è¾¾åˆ°ã€ŒæŸä¸ªçŸ­ URL åœ¨ä½¿ç”¨åçš„ä¸€æ®µæ—¶é—´åï¼Œéƒ½ä¸ä¼šè¢«éšæœºåˆ°ï¼ˆä¸ä¼šåœ¨è¿‡æœŸåå°±è¢«è¿…é€Ÿé‡ç”¨ï¼‰ã€çš„ä½œç”¨ï¼Œè¿™ä¸€ç‚¹å¯ä»¥é€šè¿‡è°ƒå¤§ kk å€¼æ¥è¿›ä¸€æ­¥ä¿è¯ã€‚
     *
     * ä½œè€…ï¼šAC_OIer
     * é“¾æ¥ï¼šhttps://leetcode.cn/problems/encode-and-decode-tinyurl/solution/by-ac_oier-ca6o/
     * æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰
     * è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚
     */
    String str = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";
    String prefix = "http://tinyurl.com/";
    Map<String, String> longToTiny = new HashMap<>();
    Map<String, String> tinyToLong = new HashMap<>();
    Random ran = new Random();
    int TinyUrlSize = 6;

    // Encodes a URL to a shortened URL.
    public String encode(String longUrl) {
        while (!longToTiny.containsKey(longUrl)) {
            char[] encode = new char[6];
            for (int i = 0; i < TinyUrlSize; i++) {
                encode[i] = str.charAt(ran.nextInt(str.length()));
            }
            String tinyUrl = prefix + String.valueOf(encode);
            if (tinyToLong.containsKey(tinyUrl)){
                continue;
            }
            longToTiny.put(longUrl,tinyUrl);
            tinyToLong.put(tinyUrl,longUrl);
        }
        return longToTiny.get(longUrl);
    }

    // Decodes a shortened URL to its original URL.
    public String decode(String shortUrl) {
        return tinyToLong.get(shortUrl);
    }
}

// Your Codec object will be instantiated and called as such:
// Codec codec = new Codec();
// codec.decode(codec.encode(url));